<div class="page-container">
  <div class="card-list">
    <div class="card-header">
      <div class="header-content">
        <h2>Mot√©is</h2>
        <p class="subtitle">Reserve uma su√≠te</p>
      </div>
      <button *ngIf="isAdmin" class="btn-new" [routerLink]="['/motel/new']">
        <span class="icon">+</span> Adicionar Motel
      </button>
    </div>

    <div class="card-body">
      <div *ngIf="motels.length === 0" class="empty-state">
        <span class="empty-icon">üè¢</span>
        <p>Nenhum motel encontrado.</p>
      </div>

      <div *ngIf="motels.length > 0" class="table-responsive">
        <table class="main-table">
          <thead>
            <tr>
              <th class="col-name">Nome</th>
              <th class="col-address">Endere√ßo</th>
              <th class="col-phone">Telefone</th>
              <th class="col-actions" *ngIf="isAdmin">A√ß√µes</th>
              <th class="col-suites">Gerenciar Su√≠tes</th>
            </tr>
          </thead>
          <tbody>
            <ng-container *ngFor="let motel of motels">
              <tr class="motel-row" [class.active-row]="selectedMotelId === motel.id && showAvailableSuites">
                <td class="col-name">{{ motel.name }}</td>
                <td class="col-address">{{ motel.address }}</td>
                <td class="col-phone">{{ motel.phone }}</td>
                <td class="col-actions" *ngIf="isAdmin">
                  <div class="action-buttons">
                    <button class="btn-icon btn-edit" [routerLink]="['/motel/edit', motel.id]" title="Editar">
                      ‚úèÔ∏è
                    </button>
                    <button class="btn-icon btn-delete" (click)="deleteMotel(motel.id)" title="Excluir">
                      üóëÔ∏è
                    </button>
                  </div>
                </td>
                <td class="col-suites">
                  <button class="btn-toggle" [class.expanded]="selectedMotelId === motel.id && showAvailableSuites"
                    (click)="toggleAvailableSuites(motel.id!)">
                    {{ selectedMotelId === motel.id && showAvailableSuites ? 'Ocultar' : 'Visualizar' }}
                  </button>
                </td>
              </tr>

              <!-- Nested Suites Row -->
              <tr *ngIf="selectedMotelId === motel.id && showAvailableSuites" class="suites-row">
                <td [attr.colspan]="isAdmin ? 5 : 4" class="suites-cell">
                  <div class="suites-wrapper">
                    <div class="suites-header">
                      <h5>Su√≠tes Dispon√≠veis - {{ motel.name }}</h5>
                    </div>

                    <div *ngIf="availableSuites.length > 0" class="suites-grid">
                      <table class="suites-table">
                        <thead>
                          <tr>
                            <th>Imagem</th>
                            <th>Nome</th>
                            <th>Descri√ß√£o</th>
                            <th>Pre√ßo/Per√≠odo</th>
                            <th>Ocupa√ß√£o</th>
                            <th>A√ß√µes</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr *ngFor="let suite of availableSuites">
                            <td class="suite-img-cell">
                              <img *ngIf="suite.image" [src]="suite.image" alt="{{ suite.name }}"
                                class="suite-thumbnail">
                              <span *ngIf="!suite.image" class="no-image">üñºÔ∏è</span>
                            </td>
                            <td><strong>{{ suite.name }}</strong></td>
                            <td class="desc-cell">{{ suite.description }}</td>
                            <td class="price">{{ suite.pricePerPeriod | currency }}</td>
                            <td>{{ suite.maxOccupancy }} pessoas</td>
                            <td>
                              <div class="suite-actions">
                                <button class="btn-sm btn-reserve" [routerLink]="['/reserve/new']"
                                  [queryParams]="{ suiteId: suite.id, motelId: motel.id }">
                                  Reservar
                                </button>
                                <button *ngIf="isAdmin" class="btn-sm btn-remove"
                                  (click)="deleteAvailableSuite(motel.id!, suite.id!)">
                                  Remover
                                </button>
                              </div>
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>

                    <div *ngIf="availableSuites.length === 0" class="suites-empty">
                      <p>Nenhuma su√≠te dispon√≠vel para este motel.</p>
                    </div>
                  </div>
                </td>
              </tr>
            </ng-container>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>